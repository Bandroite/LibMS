/**
 * ===============================================================================
 * * COPIES AJAX FILE
 * -------------------------------------------------------------------------------
 * This is for managing copies
 * ===============================================================================
 */

 $(() => {
    loadCopiesDT()
})

/**
 * ===============================================================================
 * GET ALL COPIES AJAX
 * ===============================================================================
 */

loadCopiesDT = () => {
    const dt = $('#copiesDT');
    if(dt.length){
        dt.DataTable({
            ajax: {
                url: `${ BASE_URL_API }librarian/copies`,
                type: 'GET',
                headers: AJAX_HEADERS,
                // success: (result) => {
                //     if(result){
                //         const data = result.data;
                //         console.log(data);
                //     }
                //     else{
                //         console.log('No result');
                //     }
                // }
            },
            columns: [
                {
                    data: 'copyNumber'
                },
                {
                    data: null,
                    render: (data) =>{
                        if(data.status == 'Available'){
                            return `
                                <div class="badge alert-success text-success p-2 w-100">Available</div>
                            `
                        }
                        else{
                            return `
                                <div class="badge alert-secondary text-secondary p-2 w-100">Weeded</div>
                            `
                        }
                    }
                },
                {
                    data: null,
                    class: 'text-center',
                    render: (data) => {
                        return `
                            <div class="dropdown d-inline-block">
                                <div data-toggle="dropdown">
                                    <div 
                                        class       = "btn btn-sm btn-muted"
                                        data-toggle = "tooltip"
                                        title       = "More"
                                    >
                                        <i class="fas fa-ellipsis-v"></i>
                                    </div>
                                </div>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <div 
                                        class="dropdown-item"
                                        onclick = "editCopy('${data.copyID}')"
                                    >
                                        <i class="fas fa-edit dropdown-icon-item text-blue"></i>
                                        <span>Edit</span>
                                    </div>
                                    <div 
                                        class="dropdown-item"
                                        onclick = "removeCopy('${data.copyID}')"
                                    >
                                        <i class="fas fa-trash-alt dropdown-icon-item text-danger"></i>
                                        <span>Remove</span>
                                    </div>
                                </div>
                            </div>
                        `
                    }
                },
            ],
            columnDefs: [{
                targets: [2],
                orderable: false,
            }]
        })
    }
}